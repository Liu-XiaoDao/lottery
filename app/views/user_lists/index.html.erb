<% provide :c_active, "user_lists" %>
<%= render 'shared/navigation' %>


<% if @users.present? %>
<table class="uk-table uk-table-hover">
  <thead>
    <tr>
      <th>头像</th>
      <th>姓名</th>
      <th>电话</th>
      <th>工牌</th>
      <th>激活</th>
      <th>删除</th>
    </tr>
  </thead>
  <% @users.each do |user| %>
      <tr>
        <td><img src="<%= user.avatar_url %>" style="height:50px; border: 1px #eee solid; border-radius: 5px;" /></td>
      	<td><%= user.name %></td>
      	<td><%= user.phone %></td>
      	<td><%= "#{user.pre}#{user.attendance}" %></td>
      	<td><%= user.is_active ? "已激活" : "<a href='/users/active?id=#{user.id}'>激活</a>".html_safe %></td>
      	<td><a href="/users/delete?id=<%=user.id%>">删除</a></td>
      </tr>
  <% end %>
</table>
<% end %>




<%= stylesheet_link_tag    '/media/css/components/upload.css' %>
<%= javascript_include_tag '/media/js/components/upload.min.js' %>

<script type="text/javascript">
$(function(){

  var progressbar = $("#progressbar"),
      bar         = progressbar.find('.uk-progress-bar'),
      settings    = {
        action: '/user_lists/import_preview', // 上传路径 url
        allow : '*.(jpg|jpeg|gif|png|xlsx)', // 只允许上传图片
        loadstart: function() {
            bar.css("width", "0%").text("0%");
            progressbar.removeClass("uk-hidden");
        },
        progress: function(percent) {
            percent = Math.ceil(percent);
            bar.css("width", percent+"%").text(percent+"%");
        },
        allcomplete: function(response) {
            bar.css("width", "100%").text("100%");
            setTimeout(function(){
                progressbar.addClass("uk-hidden");
            }, 250);
            alert("Upload Completed")
        }
    };

  var select = UIkit.uploadSelect($("#upload-select"), settings),
      drop   = UIkit.uploadDrop($("#upload-drop"), settings);
});
</script>
