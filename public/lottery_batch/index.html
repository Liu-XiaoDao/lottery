<!DOCTYPE html>
<html>
	<head>
		<title>abcam年会抽奖 - 2023</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="index.css">
	</head>
	<body>
		<div id="container"></div>
		<div id="menu">
			<!-- 抽奖个数：<input id="count" type="text" maxlength="3" value="1" /><br> -->
			<button id="start">开始抽奖</button><br>
			<button id="stop">停止抽奖</button><br>
			<button id="luckyers">中奖名单</button>
		</div>
		<div id="list">
			<div class="title">中奖名单</div>
			<div class="list-box"></div>
		</div>
		<div id="tip"></div>
		<div id="tip2">
			<div class="lottery-text">当前奖项：九等奖<br>抽取名额：20</div>
		</div>
		<div id="countdown"></div>
		<div id="info"></div>
		<audio id="music" src="./mp3/bg.mp3" preload="auto" controls loop="loop" style="display:none;"></audio>

		<script src="./js/jquery-2.2.4.min.js"></script>
		<script src="./js/three.js"></script>
		<script src="./js/tween.min.js"></script>
		<script src="./js/TweenMax.min.js"></script>
		<script src="./js/TrackballControls.js"></script>
		<script src="./js/CSS3DRenderer.js"></script>
		<script src="./js/lodash.js"></script>
		<script src="./js/config.js"></script>

		<script>
			var currentLevel; //当前奖项情况
			var lotteryUsers = [];	//可抽奖员工列表
			var luckyers = [];	//中奖人员列表
			var total;

			var copies = [];	//可抽人员副本
			var isFirst = true;	//是否第一次抽
			var lotteryCount = 1; //抽奖个数
			var timeid;
			var timeid_eff;
			var index = 0;
			var isTimer = false;
			var isStop = true;	//抽奖停止
			var time = 1;
			var isOver = false;
			
			var camera, scene, renderer;
			var controls;

			var objects = [];
			var targets = { table: [], sphere: [], helix: [], grid: [] };

			var btnStart = document.getElementById('start');
			var btnStop = document.getElementById('stop');
			var tip = document.getElementById('tip');
			var btnLuckyers = document.getElementById('luckyers');
			
			var cols;
			var rows;
			var imgs = ['./img/1.jpg','./img/02.png','./img/03.png','./img/04.png','./img/05.png','./img/06.png','./img/07.png','./img/08.png','./img/09.png'];
			var shapes = ['table', 'sphere', 'helix', 'grid'];


			camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 20000 );
			scene = new THREE.Scene();


			//数组元素乱序
			Array.prototype.shuffle = function() {
			    var input = this;

			    for (var i = input.length-1; i >=0; i--) {

			        var randomIndex = Math.floor(Math.random()*(i+1));
			        var itemAtIndex = input[randomIndex];

			        input[randomIndex] = input[i];
			        input[i] = itemAtIndex;
			    }
			    return input;
			}


      lotteryUsers = [
        {name: "齐英", jobNo: "100001", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "谭兴梅", jobNo: "100002", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈玉平", jobNo: "100003", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴位芳", jobNo: "100004", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐水琴", jobNo: "100005", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "施丽君", jobNo: "100006", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张承丽", jobNo: "100007", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "裘佳栋", jobNo: "100008", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郑丽云", jobNo: "100009", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汤雷", jobNo: "100010", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "项春梅", jobNo: "100011", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "蔡静", jobNo: "100012", lucky: "", deptName: "Reward", dept4Name: "xxxx"},
        {name: "刘恋", jobNo: "100013", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈卿", jobNo: "100014", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈怡", jobNo: "100015", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄敏", jobNo: "100016", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈锭", jobNo: "100017", lucky: "", deptName: "Procurement", dept4Name: "xxxx"},
        {name: "李颖洁", jobNo: "100018", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "丁琰", jobNo: "100019", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "庄海霁", jobNo: "100020", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "陈金霞", jobNo: "100021", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "沈平", jobNo: "100022", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郭森良", jobNo: "100023", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈俊刚", jobNo: "100024", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "叶华", jobNo: "100025", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "王文燕", jobNo: "100026", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐碧", jobNo: "100027", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "杨志华", jobNo: "100028", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "蒋忠根", jobNo: "100029", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张琦", jobNo: "100030", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "管丽丹", jobNo: "100031", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "任帆", jobNo: "100032", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "朱孜彬", jobNo: "100033", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "钱晶", jobNo: "100034", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "李彩兰", jobNo: "100035", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "卢正芳", jobNo: "100036", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张晶晶", jobNo: "100037", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王维娜", jobNo: "100038", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "蔡灵霞", jobNo: "100039", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "严骏", jobNo: "100040", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "华慧奇", jobNo: "100041", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "姜仙菊", jobNo: "100042", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "胡笑丽", jobNo: "100043", lucky: "", deptName: "Digital Customer", dept4Name: "xxxx"},
        {name: "胡红桥", jobNo: "100044", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "卢文成", jobNo: "100045", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张鑫", jobNo: "100046", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "鲁建建", jobNo: "100047", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张宏", jobNo: "100048", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "戈双香", jobNo: "100049", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "于飞进", jobNo: "100050", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "徐炉李", jobNo: "100051", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邹艳艳", jobNo: "100052", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈艳莉", jobNo: "100053", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "蒋琪", jobNo: "100054", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王慧", jobNo: "100055", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "楼航超", jobNo: "100056", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "方丽仙", jobNo: "100057", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "王冰", jobNo: "100058", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐芳", jobNo: "100059", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汤春生", jobNo: "100060", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡军海", jobNo: "100061", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "何沙", jobNo: "100062", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈光荣", jobNo: "100063", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李运", jobNo: "100064", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "郭献强", jobNo: "100065", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "周戈晨", jobNo: "100066", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "邵森广", jobNo: "100067", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈龙", jobNo: "100068", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汪娇菊", jobNo: "100069", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余宏峰", jobNo: "100070", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "包永玲", jobNo: "100071", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郁平强", jobNo: "100072", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "付锦荣", jobNo: "100073", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "倪雪雄", jobNo: "100074", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "葛彩霞", jobNo: "100075", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘慎", jobNo: "100076", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李晓球", jobNo: "100077", lucky: "", deptName: "Core Finance", dept4Name: "xxxx"},
        {name: "李瑞芳", jobNo: "100078", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王玲", jobNo: "100079", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "卢英磊", jobNo: "100080", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "费滢", jobNo: "100081", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "施晶晶", jobNo: "100082", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王丽萍", jobNo: "100083", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "叶继策", jobNo: "100084", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邓梦丽", jobNo: "100085", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张玉川", jobNo: "100086", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周国华", jobNo: "100087", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "华阿敏", jobNo: "100088", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "郭四美", jobNo: "100089", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "赵逸夫", jobNo: "100090", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "俞晓芳", jobNo: "100091", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张昕霞", jobNo: "100092", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "姚坚", jobNo: "100093", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李永斌", jobNo: "100094", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄莉玲", jobNo: "100095", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "金芳燕", jobNo: "100096", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "许艳", jobNo: "100097", lucky: "", deptName: "Core Finance", dept4Name: "xxxx"},
        {name: "钱凌芝", jobNo: "100098", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邢天棋", jobNo: "100099", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "胡晓燕", jobNo: "100100", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "孙唯唯", jobNo: "100101", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李晓丽", jobNo: "100102", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "方玮", jobNo: "100103", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "应超", jobNo: "100104", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "金钱斌", jobNo: "100105", lucky: "", deptName: "Procurement", dept4Name: "xxxx"},
        {name: "许岳", jobNo: "100106", lucky: "", deptName: "FP&A and Corporate Development", dept4Name: "xxxx"},
        {name: "冉晓琳", jobNo: "100107", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "李娜", jobNo: "100108", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "谢雯", jobNo: "100109", lucky: "", deptName: "HR Leadership", dept4Name: "xxxx"},
        {name: "朱力", jobNo: "100110", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "曹文珞", jobNo: "100111", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡勇", jobNo: "100112", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周小乔", jobNo: "100113", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李高峰", jobNo: "100114", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "包余婷", jobNo: "100115", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张美娜", jobNo: "100116", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "卢兴潮", jobNo: "100117", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "刘春良", jobNo: "100118", lucky: "", deptName: "Tech Enablement", dept4Name: "xxxx"},
        {name: "刘莹", jobNo: "100119", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐梦婷", jobNo: "100120", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄俊杰", jobNo: "100121", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张楠梦子", jobNo: "100122", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "曾鹏", jobNo: "100123", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张晓艳", jobNo: "100124", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "李和玉", jobNo: "100125", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "沈薇薇", jobNo: "100126", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘昌铭", jobNo: "100127", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李晓敏", jobNo: "100128", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "唐跃春", jobNo: "100129", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "佘桂洲", jobNo: "100130", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "卢莉娜", jobNo: "100131", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周赟", jobNo: "100132", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "姜涛", jobNo: "100133", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "蒋硕卿", jobNo: "100134", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郑绍普", jobNo: "100135", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张晓倩", jobNo: "100136", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "万玮", jobNo: "100137", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "林婷婷", jobNo: "100138", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余佳倩", jobNo: "100139", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黎思", jobNo: "100140", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余娜", jobNo: "100141", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "曾瑞", jobNo: "100142", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "欧阳佳佳", jobNo: "100143", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李钰旦", jobNo: "100144", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "邵丹平", jobNo: "100145", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "徐丹丹", jobNo: "100146", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "戴建丽", jobNo: "100147", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "郑诚", jobNo: "100148", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "丁梦玥", jobNo: "100149", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈程", jobNo: "100150", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "葛挺", jobNo: "100151", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "徐美东", jobNo: "100152", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "郎肖宁", jobNo: "100153", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "邓辉", jobNo: "100154", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "韩俊峰", jobNo: "100155", lucky: "", deptName: "FP&A and Corporate Development", dept4Name: "xxxx"},
        {name: "李睿慧", jobNo: "100156", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "王秋岑", jobNo: "100157", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汪仿贤", jobNo: "100158", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "于君丽", jobNo: "100159", lucky: "", deptName: "R&D Leadership", dept4Name: "xxxx"},
        {name: "孙志豪", jobNo: "100160", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "孟菲菲", jobNo: "100161", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "汪琳悦", jobNo: "100162", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈佳青", jobNo: "100163", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "应艾琳", jobNo: "100164", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "陈李辉", jobNo: "100165", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "凡莉莉", jobNo: "100166", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴熙玲", jobNo: "100167", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "邹萍萍", jobNo: "100168", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "王标", jobNo: "100169", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "葛孚铮", jobNo: "100170", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐冯晓", jobNo: "100171", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "贾文欢", jobNo: "100172", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郑伊婷", jobNo: "100173", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "金晓微", jobNo: "100174", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "金苗", jobNo: "100175", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴雅丹", jobNo: "100176", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张扬扬", jobNo: "100177", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "刘翀", jobNo: "100178", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "田斌", jobNo: "100179", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘诗颂", jobNo: "100180", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "冀屹", jobNo: "100181", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "柯美林", jobNo: "100182", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马纯", jobNo: "100183", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周孝容", jobNo: "100184", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "赵威", jobNo: "100185", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "乔巍", jobNo: "100186", lucky: "", deptName: "People Services", dept4Name: "xxxx"},
        {name: "徐冰清", jobNo: "100187", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "易文晶", jobNo: "100188", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "应宇倩", jobNo: "100189", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "廖益娇", jobNo: "100190", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李潇", jobNo: "100191", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "方际光", jobNo: "100192", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "叶献英", jobNo: "100193", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "钱烨", jobNo: "100194", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "耿世超", jobNo: "100195", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "庄佳瑶", jobNo: "100196", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张功臣", jobNo: "100197", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘鹏涛", jobNo: "100198", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "孙佳怡", jobNo: "100199", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "余屹", jobNo: "100200", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "齐一墨", jobNo: "100201", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄建镇", jobNo: "100202", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "翁一鸣", jobNo: "100203", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈雨晴", jobNo: "100204", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周喜航", jobNo: "100205", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "于偌萱", jobNo: "100206", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐晶晶", jobNo: "100207", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王典", jobNo: "100208", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余红仙", jobNo: "100209", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "肖潇", jobNo: "100210", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "蔡子英", jobNo: "100211", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王林美", jobNo: "100212", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陶晨", jobNo: "100213", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "喻旭升", jobNo: "100214", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "吴学敏", jobNo: "100215", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "孔亚黎", jobNo: "100216", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "翁雨航", jobNo: "100217", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邢以琳", jobNo: "100218", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴佩文", jobNo: "100219", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴敏洁", jobNo: "100220", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王洁茹", jobNo: "100221", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘冉", jobNo: "100222", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈丽霞", jobNo: "100223", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "刘行", jobNo: "100224", lucky: "", deptName: "Procurement", dept4Name: "xxxx"},
        {name: "范财敬", jobNo: "100225", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "闵媛媛", jobNo: "100226", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "吴越", jobNo: "100227", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "上官慧红", jobNo: "100228", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "来卓彪", jobNo: "100229", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "何守经", jobNo: "100230", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "吴婷", jobNo: "100231", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周燕燕", jobNo: "100232", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡智奕", jobNo: "100233", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈敏敏", jobNo: "100234", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李婷", jobNo: "100235", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "江俊超", jobNo: "100236", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李琳", jobNo: "100237", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "张雯敏", jobNo: "100238", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马欣悦", jobNo: "100239", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "侯玉莹", jobNo: "100240", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周尚超", jobNo: "100241", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "奚飘飘", jobNo: "100242", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "金惜妮", jobNo: "100243", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张梦婷", jobNo: "100244", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张安琪", jobNo: "100245", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周洪涛", jobNo: "100246", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "陆彩茹", jobNo: "100247", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "杨滢", jobNo: "100248", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡玉洁", jobNo: "100249", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "黄可", jobNo: "100250", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "温世福", jobNo: "100251", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "张琳琳", jobNo: "100252", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "曲迪", jobNo: "100253", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "辛佳", jobNo: "100254", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "汪倩", jobNo: "100255", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴莉莉", jobNo: "100256", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "马姝莉", jobNo: "100257", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "陈铭佳", jobNo: "100258", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "赵莉萍", jobNo: "100259", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "邱文婷", jobNo: "100260", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "毕婉璐", jobNo: "100261", lucky: "", deptName: "Core Finance", dept4Name: "xxxx"},
        {name: "舒鑫", jobNo: "100262", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "蓝轩", jobNo: "100263", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "范春梅", jobNo: "100264", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李超峰", jobNo: "100265", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "周佳霓", jobNo: "100266", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "马慧敏", jobNo: "100267", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张旭", jobNo: "100268", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "高若男", jobNo: "100269", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张锦荣", jobNo: "100270", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "何霄", jobNo: "100271", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "姜囡鹃", jobNo: "100272", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "姜鹏芳", jobNo: "100273", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "何雪", jobNo: "100274", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "马文羽", jobNo: "100275", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郭佳", jobNo: "100276", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "袁璇", jobNo: "100277", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "蒋晨楷", jobNo: "100278", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "王凯琪", jobNo: "100279", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘烨", jobNo: "100280", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张看", jobNo: "100281", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "包京京", jobNo: "100282", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "吴赛", jobNo: "100283", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "牛盼聪", jobNo: "100284", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "赵美晶", jobNo: "100285", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "褚浩南", jobNo: "100286", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘贝贝", jobNo: "100287", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马唯", jobNo: "100288", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "非林清", jobNo: "100289", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "赵卓园", jobNo: "100290", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马馨雨", jobNo: "100291", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘玲", jobNo: "100292", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "宋凯丽", jobNo: "100293", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "徐淼泽", jobNo: "100294", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李荣洁", jobNo: "100295", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "方雄", jobNo: "100296", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "马翼之", jobNo: "100297", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "黄弟翔", jobNo: "100298", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "周奕晴", jobNo: "100299", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王冰烃", jobNo: "100300", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "罗晨", jobNo: "100301", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "姚凯龙", jobNo: "100302", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "苏灿", jobNo: "100303", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "吴小婷", jobNo: "100304", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "马世祺", jobNo: "100305", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "孙莹", jobNo: "100306", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "苏燕", jobNo: "100307", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "姚敏", jobNo: "100308", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "徐黎晖", jobNo: "100309", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴鸿杰", jobNo: "100310", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邢敏慧", jobNo: "100311", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "荣方静", jobNo: "100312", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王菁华", jobNo: "100313", lucky: "", deptName: "Research Areas & Collaborations", dept4Name: "xxxx"},
        {name: "陈佳文", jobNo: "100314", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郭志新", jobNo: "100315", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "俞小芳", jobNo: "100316", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "栾硕", jobNo: "100317", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈娴", jobNo: "100318", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "黄晓斌", jobNo: "100319", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "郭亭亭", jobNo: "100320", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "张志龙", jobNo: "100321", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "张靖文", jobNo: "100322", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "杨妍", jobNo: "100323", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邓珂", jobNo: "100324", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈学钊", jobNo: "100325", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "张皓泉", jobNo: "100326", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "方思佳", jobNo: "100327", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李亭", jobNo: "100328", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "韩迎春", jobNo: "100329", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "方鑫园", jobNo: "100330", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴瑶函", jobNo: "100331", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "冯滢", jobNo: "100332", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "范闪闪", jobNo: "100333", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "梁彤雨", jobNo: "100334", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "毛怡俊", jobNo: "100335", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "杨利娜", jobNo: "100336", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吕向阳", jobNo: "100337", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "占永杰", jobNo: "100338", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "张凯", jobNo: "100339", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "彭晖", jobNo: "100340", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "洪运", jobNo: "100341", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周逸阳", jobNo: "100342", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "方珍珍", jobNo: "100343", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汪洋", jobNo: "100344", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "夏雨欣", jobNo: "100345", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邹童瑶", jobNo: "100346", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "叶艳玲", jobNo: "100347", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "司琪", jobNo: "100348", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "袁朝栋", jobNo: "100349", lucky: "", deptName: "Digital Customer", dept4Name: "xxxx"},
        {name: "刘云玥", jobNo: "100350", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "郑良明", jobNo: "100351", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "王舒欣", jobNo: "100352", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "李恒凯", jobNo: "100353", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"}
      ]

			init();

			function init() {
				var current;
				var posY;
				var removeRow;

				luckyers = localStorage.getItem('luckyers') ? JSON.parse(localStorage.getItem('luckyers')) : [];

				//移除中奖者
				_.remove(lotteryUsers, function(item) {
					var luckyer = {};
					luckyers.forEach(function(n){
						if(item.jobNo == n.jobNo) luckyer = n
					});
					return luckyer.jobNo == item.jobNo
				});

				//洗牌
				lotteryUsers.shuffle();

				renderLotteryInfo();

				cols = 30;
				rows = Math.ceil(lotteryUsers.length / cols);
				
				camera.position.set( 0, 0, 6000);

				removeRow = parseInt(luckyers.length / cols);
				posY = 1000 - removeRow * 50;

				// reset
				index = 0;
				copies = [];
				objects = [];
				targets = { table: [], sphere: [], helix: [], grid: [] };
				while(scene.children.length > 0){ 
				    scene.remove(scene.children[0]); 
				}

				// table
				for ( var i = 0; i < rows; i++ ) {
					for (var j = 0; j < cols; j++){
						if (!(index >= lotteryUsers.length)) {
							current = lotteryUsers[index];

							var element = document.createElement( 'div' );
							element.setAttribute('id', 'item_' + index++);
							element.className = 'element';
							element.style.backgroundColor = 'rgba(0,127,127,' + ( Math.random() * 0.5 + 0.25 ) + ')';

							// var img = document.createElement('img');
							// img.className = 'img';
							// img.src = imgs[0];
							// element.appendChild(img);

							var username = document.createElement( 'div' );
							username.className = 'name';
							username.innerHTML = current['name'];
							element.appendChild( username );

							var jobno = document.createElement( 'div' );
							jobno.className = 'jobno';
							jobno.innerHTML = current['jobNo'];
							element.appendChild( jobno );

							var object = new THREE.CSS3DObject( element );
							object.position.x = Math.random() * 4000 - 2000;
							object.position.y = Math.random() * 4000 - 2000;
							object.position.z = Math.random() * 4000 - 2000;
							scene.add( object );

							objects.push( object );
							copies.push(current);

							var object = new THREE.Object3D();
							object.position.x = ( j * 140 ) - 1800;
							object.position.y = - ( i * 140 ) + rows * 140 / 2;

							targets.table.push( object );
						}
					}
				}

				// sphere
				var vector = new THREE.Vector3();
				var spherical = new THREE.Spherical();
				for ( var i = 0, l = objects.length; i < l; i ++ ) {
					var phi = Math.acos( -1 + ( 2 * i ) / l );
					var theta = Math.sqrt( l * Math.PI ) * phi;
					var object = new THREE.Object3D();
					spherical.set( 800, phi, theta );
					object.position.setFromSpherical( spherical );
					vector.copy( object.position ).multiplyScalar( 2 );
					object.lookAt( vector );
					targets.sphere.push( object );
				}

				// grid
				for ( var i = 0; i < objects.length; i ++ ) {
					var object = new THREE.Object3D();
					object.position.x = ( ( i % 5 ) * 400 ) - 800;
					object.position.y = ( - ( Math.floor( i / 5 ) % 5 ) * 400 ) + 800;
					object.position.z = ( Math.floor( i / 25 ) ) * 1000 - 2000;
					targets.grid.push( object );
				}

				renderer = new THREE.CSS3DRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.domElement.style.position = 'absolute';
				document.getElementById( 'container' ).appendChild( renderer.domElement );

				controls = new THREE.TrackballControls( camera, renderer.domElement );
				this.zoomSpeed = 1;
				this.panSpeed = 0.2;
				controls.addEventListener( 'change', render );

				transform( targets.table, 2000 );
				animate();

				setTimeout(function() {
					$('#menu').fadeIn();
				}, 2000);
			}

			//更新抽奖中奖信息
			function renderLotteryInfo(){
				var group = _.groupBy(luckyers, 'lucky');
				var listHtml = '';
				console.log('中奖情况', group);

				for(var i = 0,len = prizeLevel.length; i < len; i++){
					var item = prizeLevel[i];
					var levelName = item.label; //奖项名称
					var levelLuckyers = group[levelName]; //该奖项中奖名单

					if(levelLuckyers){
						if(levelLuckyers.length == item.count){ //该奖项已抽完
							item.complete = true;
							item.surplus = 0;
						}else{	//未抽完
							item.surplus = item.count - levelLuckyers.length;
							currentLevel = item;
							break
						}
					}else{
						currentLevel = item;
						break
					}
				}
				console.log('当前奖项情况', currentLevel);
				
				if(currentLevel != undefined){
					if(currentLevel.label == 'levelTD' && currentLevel.surplus == 0){
						isOver = true;
						$('#info,#start,#stop').hide();
					}else{
						$('#info').html('接下来抽：'+currentLevel.text+'<br>剩余：'+currentLevel.surplus);
					}
					
				}
				for(var o in group){
					console.log(group);
					console.log(o);
					var level = _.find(prizeLevel, {'label': o});
					listHtml += '<h6>'+level.text+'</h6>';
					listHtml += '<ul>';
					group[o].forEach(function(item, index){
						listHtml += '<li>' + item.name + ' ' + item.jobNo + '</li>';
					});
					listHtml += '</ul>';
				}
				$('.list-box').html(listHtml);
			}


			//倒计时
        function timer() {
          if (time == 0) {
				  	isTimer = false;
					  $('#tip2, #countdown').fadeOut();
					  lotteryAni();
              time = 1;
            } else {
					      isTimer = true;
					      $('#countdown').text('GO');
					      TweenLite.fromTo($('#countdown'), 0.3, { autoAlpha: 0, scale: 0 }, { autoAlpha: .8, scale: 1, ease: Back.easeInOut, onComplete: function(){
						    time--;
						    setTimeout(function () {
							    timer();
						    },1000);
					}});
					
                }
            }


			function start() {
				if(!currentLevel) return false

				var tip = '';

				if (isStop) {
					isStop = false;
					document.getElementById('music').play();
					lotteryCount = currentLevel.n;

					if(currentLevel.n > currentLevel.surplus){
						lotteryCount = currentLevel.surplus;
					}

					hideTip();

					tip = '当前奖项：' + currentLevel.text + '<br>抽取名额：' + lotteryCount;
					
					$('.lottery-text').html(tip);
					$('#tip2, #countdown').fadeIn();

					timer();
				}
			}

			function lotteryAni(){
				var userLen = lotteryUsers.length;
				var movement = 0;

				if(userLen <= 353 && userLen > 326){ //阳光奖形式
					var seed = 1;
					var piece = parseInt(userLen / 25);
					var m = userLen / 1400;
					
					transform(targets.grid, 2000);
					camera.position.set( -100, 100, 1000 * piece); //1000为grid下的两片之间的距离

					function run() {
						if (movement < userLen) {
							seed += 0.005;
							controls.move(seed);
							movement += m;
						}else{
							movement = 0;
							seed = 1;
							camera.position.set( -100, 100, 1000 * piece);
						}
						timeid_eff = setTimeout(run, 10);
					}
					timeid_eff = setTimeout(run, 10);

					active();
				}else{ //剩余奖项形式
					var far = 4000;
					transform(targets.sphere, 1000);
					camera.position.set( 0, 0, 3000);

					function run() {
						movement = 0.002;
						controls.rotateCamera2(new THREE.Vector2(movement,0));
						timeid_eff = setTimeout(run, 20);
					}
					timeid_eff = setTimeout(run, 20);

					active2();
				}
			}


			function active() {
				timeid = setInterval(function() {
					$('.element').removeClass('active');
					var len = copies.length;
					var itemId1 = Math.floor(Math.random() * len);
					var itemId2 = Math.floor(Math.random() * len);
					var itemId3 = Math.floor(Math.random() * len);
					var itemId4 = Math.floor(Math.random() * len);
					var itemId5 = Math.floor(Math.random() * len);
					var itemId6 = Math.floor(Math.random() * len);
					var itemId7 = Math.floor(Math.random() * len);
					var itemId8 = Math.floor(Math.random() * len);
					$('#item_' + itemId1).addClass('active');
					$('#item_' + itemId2).addClass('active');
					$('#item_' + itemId3).addClass('active');
					$('#item_' + itemId4).addClass('active');
					$('#item_' + itemId5).addClass('active');
					$('#item_' + itemId6).addClass('active');
					$('#item_' + itemId7).addClass('active');
					$('#item_' + itemId8).addClass('active');
				}, 100);
			}

			function active2() {
				timeid = setInterval(function() {
					$('.element').removeClass('active');
					var len = copies.length;
					var itemId = Math.floor(Math.random() * len);
					$('#item_' + itemId).addClass('active');
				}, 100);
			}

			function stop(){
				var luckyNums,
					jobNo,
					name,
					luckyHtml = '<h2>恭喜'+currentLevel.text+'获得者</h2>',
					listHtml,
					param = [];

				isStop = true;
				document.getElementById('music').pause();

				if(lotteryCount > 30){
					$('#tip').addClass('wide');
					itemClass = 'luckyer-item4';
				}else if(lotteryCount > 10 && lotteryCount <= 30){
					$('#tip').removeClass('wide');
					itemClass = 'luckyer-item2';
				}else{
					$('#tip').removeClass('wide');
					itemClass = 'luckyer-item1';
				}

				
				if (timeid) {
					clearInterval(timeid);
				}
				if(timeid_eff){
					clearTimeout(timeid_eff);
				}

				for(var i = 0; i < lotteryCount; i++){
					var luckyNum = rand();
					var luckyItem = copies[luckyNum];
					luckyItem['lucky'] = currentLevel.label;
					luckyItem['remark'] = currentLevel.text;
					luckyHtml += '<div class="'+itemClass+'">' + luckyItem['name'] + ' '+ luckyItem['jobNo'] + '</div>';
					luckyers.push(luckyItem);
					param.push(luckyItem);
					delete copies[luckyNum];
				}

				localStorage.setItem('luckyers', JSON.stringify(luckyers));

				console.log('抽奖副本', copies);

				$('.element').removeClass('active');
				listHtml = $('<div class="luckyer-list"></div>').append(luckyHtml);
				$('#tip').append(listHtml).fadeIn();

				renderLotteryInfo();
				setTimeout(function(){
					init();
				}, 500);

					
			}

			function rand() {
				var n = Math.floor(Math.random() * copies.length);
				return copies[n] ? n : rand();
			}


			function hideTip() {
				$('#tip').fadeOut(function() {
					$(this).empty();
				});
			}

			function transform( targets, duration ) {
				TWEEN.removeAll();

				for ( var i = 0; i < objects.length; i ++ ) {
					var object = objects[ i ];
					var target = targets[ i ];

					new TWEEN.Tween( object.position )
						.to( { x: target.position.x, y: target.position.y, z: target.position.z }, Math.random() * duration + duration )
						.easing( TWEEN.Easing.Exponential.InOut )
						.start();

					new TWEEN.Tween( object.rotation )
						.to( { x: target.rotation.x, y: target.rotation.y, z: target.rotation.z }, Math.random() * duration + duration )
						.easing( TWEEN.Easing.Exponential.InOut )
						.start();
				}

				new TWEEN.Tween( this )
					.to( {}, duration * 2 )
					.onUpdate( render )
					.start();
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
				render();
			}

			function animate() {
				requestAnimationFrame( animate );
				TWEEN.update();
				controls.update();
			}

			function render() {
				renderer.render( scene, camera );
			}



			btnStart.addEventListener( 'click', function ( event ) {
				start();
				$('#start').blur();
			}, false );

			btnStop.addEventListener( 'click', function ( event ) {
				if(!isStop && !isTimer){
					stop();
				}
				
				$('#stop').blur();
			}, false );

			tip.addEventListener( 'click', function ( event ) {
				hideTip();
			}, false );

			btnLuckyers.addEventListener( 'click', function ( event ) {
				$('#list').fadeIn();
			}, false );

			$('#list').on('click', function ( event ) {
				$(this).fadeOut();
			});

			$(document).keydown(function(e){
			    if(!e) var e = window.event; 
			    if(e.keyCode == 32){
					if(isOver) return false;
			        if(isStop){
			        	start();
			        }else{
			        	if(!isTimer) stop();
			        }
			    }
			 });

			window.addEventListener( 'resize', onWindowResize, false );

		</script>
	</body>
</html>
