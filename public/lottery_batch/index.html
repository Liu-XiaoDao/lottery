<!DOCTYPE html>
<html>
	<head>
		<title>abcam年会抽奖 - 2023</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="index.css">
	</head>
	<body>
		<div id="container"></div>
		<div id="menu">
			<!-- 抽奖个数：<input id="count" type="text" maxlength="3" value="1" /><br> -->
			<button id="start">开始抽奖</button><br>
			<button id="stop">停止抽奖</button><br>
			<button id="luckyers">中奖名单</button>
		</div>
		<div id="list">
			<div class="title">中奖名单</div>
			<div class="list-box"></div>
		</div>
		<div id="tip"></div>
		<div id="tip2">
			<div class="lottery-text">当前奖项：九等奖<br>抽取名额：20</div>
		</div>
		<div id="countdown"></div>
		<div id="info"></div>
		<audio id="music" src="./mp3/bg.mp3" preload="auto" controls loop="loop" style="display:none;"></audio>

		<script src="./js/jquery-2.2.4.min.js"></script>
		<script src="./js/three.js"></script>
		<script src="./js/tween.min.js"></script>
		<script src="./js/TweenMax.min.js"></script>
		<script src="./js/TrackballControls.js"></script>
		<script src="./js/CSS3DRenderer.js"></script>
		<script src="./js/lodash.js"></script>
		<script src="./js/config.js"></script>

		<script>
			var currentLevel; //当前奖项情况
			var lotteryUsers = [];	//可抽奖员工列表
			var luckyers = [];	//中奖人员列表
			var total;

			var copies = [];	//可抽人员副本
			var isFirst = true;	//是否第一次抽
			var lotteryCount = 1; //抽奖个数
			var timeid;
			var timeid_eff;
			var index = 0;
			var isTimer = false;
			var isStop = true;	//抽奖停止
			var time = 1;
			var isOver = false;
			
			var camera, scene, renderer;
			var controls;

			var objects = [];
			var targets = { table: [], sphere: [], helix: [], grid: [] };

			var btnStart = document.getElementById('start');
			var btnStop = document.getElementById('stop');
			var tip = document.getElementById('tip');
			var btnLuckyers = document.getElementById('luckyers');
			
			var cols;
			var rows;
			var imgs = ['./img/1.jpg','./img/02.png','./img/03.png','./img/04.png','./img/05.png','./img/06.png','./img/07.png','./img/08.png','./img/09.png'];
			var shapes = ['table', 'sphere', 'helix', 'grid'];


			camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 20000 );
			scene = new THREE.Scene();


			//数组元素乱序
			Array.prototype.shuffle = function() {
			    var input = this;

			    for (var i = input.length-1; i >=0; i--) {

			        var randomIndex = Math.floor(Math.random()*(i+1));
			        var itemAtIndex = input[randomIndex];

			        input[randomIndex] = input[i];
			        input[i] = itemAtIndex;
			    }
			    return input;
			}


      lotteryUsers = [
        {name: "齐英", jobNo: "980090", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "谭兴梅", jobNo: "980092", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈玉平", jobNo: "980093", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴位芳", jobNo: "980094", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐水琴", jobNo: "980095", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "施丽君", jobNo: "980096", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张承丽", jobNo: "980097", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "裘佳栋", jobNo: "980098", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郑丽云", jobNo: "980099", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汤雷", jobNo: "980100", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "项春梅", jobNo: "980101", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "蔡静", jobNo: "980102", lucky: "", deptName: "Reward", dept4Name: "xxxx"},
        {name: "刘恋", jobNo: "980104", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈卿", jobNo: "980106", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈怡", jobNo: "980109", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄敏", jobNo: "980110", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈锭", jobNo: "980111", lucky: "", deptName: "Procurement", dept4Name: "xxxx"},
        {name: "李颖洁", jobNo: "980112", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "丁琰", jobNo: "980114", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "庄海霁", jobNo: "980115", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "陈金霞", jobNo: "980116", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "沈平", jobNo: "980117", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郭森良", jobNo: "980118", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈俊刚", jobNo: "980119", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "叶华", jobNo: "980120", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "王文燕", jobNo: "980121", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐碧", jobNo: "980122", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "杨志华", jobNo: "980123", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "蒋忠根", jobNo: "980125", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张琦", jobNo: "980127", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "管丽丹", jobNo: "980128", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "任帆", jobNo: "980132", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "朱孜彬", jobNo: "980133", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "钱晶", jobNo: "980136", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "李彩兰", jobNo: "980138", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "卢正芳", jobNo: "980140", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张晶晶", jobNo: "980142", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王维娜", jobNo: "980143", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "蔡灵霞", jobNo: "980144", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "严骏", jobNo: "980145", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "华慧奇", jobNo: "980149", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "姜仙菊", jobNo: "980150", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "胡笑丽", jobNo: "980151", lucky: "", deptName: "Digital Customer", dept4Name: "xxxx"},
        {name: "胡红桥", jobNo: "980154", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "卢文成", jobNo: "980155", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张鑫", jobNo: "980156", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "鲁建建", jobNo: "980157", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张宏", jobNo: "980159", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "戈双香", jobNo: "980160", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "于飞进", jobNo: "980161", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "徐炉李", jobNo: "980164", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邹艳艳", jobNo: "980165", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈艳莉", jobNo: "980166", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "蒋琪", jobNo: "980167", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王慧", jobNo: "980168", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "楼航超", jobNo: "980169", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "方丽仙", jobNo: "980173", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "王冰", jobNo: "980177", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐芳", jobNo: "980178", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汤春生", jobNo: "980182", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡军海", jobNo: "980184", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "何沙", jobNo: "980185", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈光荣", jobNo: "980186", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李运", jobNo: "980188", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "郭献强", jobNo: "980189", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "周戈晨", jobNo: "980190", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "邵森广", jobNo: "980192", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈龙", jobNo: "980193", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汪娇菊", jobNo: "980195", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余宏峰", jobNo: "980197", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "包永玲", jobNo: "980198", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郁平强", jobNo: "980199", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "付锦荣", jobNo: "980201", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "倪雪雄", jobNo: "980204", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "葛彩霞", jobNo: "980205", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘慎", jobNo: "980207", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李晓球", jobNo: "980208", lucky: "", deptName: "Core Finance", dept4Name: "xxxx"},
        {name: "李瑞芳", jobNo: "980212", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王玲", jobNo: "980214", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "卢英磊", jobNo: "980216", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "费滢", jobNo: "980217", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "施晶晶", jobNo: "980218", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王丽萍", jobNo: "980219", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "叶继策", jobNo: "980220", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邓梦丽", jobNo: "980222", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张玉川", jobNo: "980223", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周国华", jobNo: "980226", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "华阿敏", jobNo: "980229", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "郭四美", jobNo: "980230", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "赵逸夫", jobNo: "980231", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "俞晓芳", jobNo: "980232", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张昕霞", jobNo: "980234", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "姚坚", jobNo: "980235", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李永斌", jobNo: "980238", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄莉玲", jobNo: "980246", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "金芳燕", jobNo: "980248", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "许艳", jobNo: "980250", lucky: "", deptName: "Core Finance", dept4Name: "xxxx"},
        {name: "钱凌芝", jobNo: "980253", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邢天棋", jobNo: "980260", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "胡晓燕", jobNo: "980261", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "孙唯唯", jobNo: "980262", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李晓丽", jobNo: "980263", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "方玮", jobNo: "980269", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "应超", jobNo: "980270", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "金钱斌", jobNo: "980280", lucky: "", deptName: "Procurement", dept4Name: "xxxx"},
        {name: "许岳", jobNo: "980281", lucky: "", deptName: "FP&A and Corporate Development", dept4Name: "xxxx"},
        {name: "冉晓琳", jobNo: "980283", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "李娜", jobNo: "980286", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "谢雯", jobNo: "980288", lucky: "", deptName: "HR Leadership", dept4Name: "xxxx"},
        {name: "朱力", jobNo: "980929", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "曹文珞", jobNo: "982075", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡勇", jobNo: "982077", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周小乔", jobNo: "982331", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李高峰", jobNo: "982340", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "包余婷", jobNo: "982487", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张美娜", jobNo: "982530", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "卢兴潮", jobNo: "982575", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "刘春良", jobNo: "982719", lucky: "", deptName: "Tech Enablement", dept4Name: "xxxx"},
        {name: "刘莹", jobNo: "982735", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐梦婷", jobNo: "982737", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄俊杰", jobNo: "982739", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张楠梦子", jobNo: "982775", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "曾鹏", jobNo: "982800", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张晓艳", jobNo: "982802", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "李和玉", jobNo: "982804", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "沈薇薇", jobNo: "983211", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘昌铭", jobNo: "983213", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李晓敏", jobNo: "983215", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "唐跃春", jobNo: "983240", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "佘桂洲", jobNo: "983306", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "卢莉娜", jobNo: "983308", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周赟", jobNo: "983328", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "姜涛", jobNo: "983397", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "蒋硕卿", jobNo: "983401", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郑绍普", jobNo: "983427", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张晓倩", jobNo: "983430", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "万玮", jobNo: "983475", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "林婷婷", jobNo: "983495", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余佳倩", jobNo: "983497", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黎思", jobNo: "983541", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余娜", jobNo: "983563", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "曾瑞", jobNo: "983569", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "欧阳佳佳", jobNo: "983573", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李钰旦", jobNo: "983575", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "邵丹平", jobNo: "983595", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "徐丹丹", jobNo: "983619", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "戴建丽", jobNo: "983621", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "郑诚", jobNo: "983623", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "丁梦玥", jobNo: "983625", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈程", jobNo: "983647", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "葛挺", jobNo: "983649", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "徐美东", jobNo: "983660", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "郎肖宁", jobNo: "983664", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "邓辉", jobNo: "983712", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "韩俊峰", jobNo: "983714", lucky: "", deptName: "FP&A and Corporate Development", dept4Name: "xxxx"},
        {name: "李睿慧", jobNo: "983792", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "王秋岑", jobNo: "983855", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汪仿贤", jobNo: "983857", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "于君丽", jobNo: "983859", lucky: "", deptName: "R&D Leadership", dept4Name: "xxxx"},
        {name: "孙志豪", jobNo: "983909", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "孟菲菲", jobNo: "984008", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "汪琳悦", jobNo: "984027", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈佳青", jobNo: "984029", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "应艾琳", jobNo: "984039", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "陈李辉", jobNo: "984041", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "凡莉莉", jobNo: "984062", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴熙玲", jobNo: "984064", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "邹萍萍", jobNo: "984081", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "王标", jobNo: "984128", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "葛孚铮", jobNo: "984159", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐冯晓", jobNo: "984195", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "贾文欢", jobNo: "984238", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郑伊婷", jobNo: "984242", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "金晓微", jobNo: "984300", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "金苗", jobNo: "984302", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴雅丹", jobNo: "984320", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张扬扬", jobNo: "984328", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "刘翀", jobNo: "984330", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "田斌", jobNo: "984336", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘诗颂", jobNo: "984369", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "冀屹", jobNo: "984422", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "柯美林", jobNo: "984430", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马纯", jobNo: "984526", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周孝容", jobNo: "984599", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "赵威", jobNo: "984644", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "乔巍", jobNo: "984782", lucky: "", deptName: "People Services", dept4Name: "xxxx"},
        {name: "徐冰清", jobNo: "984822", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "易文晶", jobNo: "984844", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "应宇倩", jobNo: "984871", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "廖益娇", jobNo: "984891", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李潇", jobNo: "984916", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "方际光", jobNo: "984918", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "叶献英", jobNo: "984934", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "钱烨", jobNo: "984989", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "耿世超", jobNo: "984991", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "庄佳瑶", jobNo: "985000", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张功臣", jobNo: "985006", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘鹏涛", jobNo: "985046", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "孙佳怡", jobNo: "985048", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "余屹", jobNo: "985133", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "齐一墨", jobNo: "985142", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "黄建镇", jobNo: "985150", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "翁一鸣", jobNo: "985179", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈雨晴", jobNo: "985186", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周喜航", jobNo: "985194", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "于偌萱", jobNo: "985223", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "徐晶晶", jobNo: "985225", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王典", jobNo: "985277", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "余红仙", jobNo: "985311", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "肖潇", jobNo: "985314", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "蔡子英", jobNo: "985316", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王林美", jobNo: "985347", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陶晨", jobNo: "985351", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "喻旭升", jobNo: "985381", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "吴学敏", jobNo: "985395", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "孔亚黎", jobNo: "985429", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "翁雨航", jobNo: "985431", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邢以琳", jobNo: "985442", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴佩文", jobNo: "985444", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴敏洁", jobNo: "985491", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王洁茹", jobNo: "985495", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘冉", jobNo: "985497", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈丽霞", jobNo: "985532", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "刘行", jobNo: "985566", lucky: "", deptName: "Procurement", dept4Name: "xxxx"},
        {name: "范财敬", jobNo: "985568", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "闵媛媛", jobNo: "985580", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "吴越", jobNo: "985598", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "上官慧红", jobNo: "985601", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "来卓彪", jobNo: "985627", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "何守经", jobNo: "985631", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "吴婷", jobNo: "985633", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周燕燕", jobNo: "985635", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡智奕", jobNo: "985637", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "陈敏敏", jobNo: "985654", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李婷", jobNo: "985660", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"},
        {name: "江俊超", jobNo: "985662", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李琳", jobNo: "985690", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "张雯敏", jobNo: "985692", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马欣悦", jobNo: "985694", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "侯玉莹", jobNo: "985696", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周尚超", jobNo: "985703", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "奚飘飘", jobNo: "985705", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "金惜妮", jobNo: "985707", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张梦婷", jobNo: "985730", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张安琪", jobNo: "985732", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周洪涛", jobNo: "985734", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "陆彩茹", jobNo: "985736", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "杨滢", jobNo: "985753", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "胡玉洁", jobNo: "985783", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "黄可", jobNo: "985785", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "温世福", jobNo: "985787", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "张琳琳", jobNo: "985789", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "曲迪", jobNo: "985791", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "辛佳", jobNo: "985793", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "汪倩", jobNo: "985795", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "吴莉莉", jobNo: "985811", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "马姝莉", jobNo: "985814", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "陈铭佳", jobNo: "985816", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "赵莉萍", jobNo: "985818", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "邱文婷", jobNo: "985820", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "毕婉璐", jobNo: "985822", lucky: "", deptName: "Core Finance", dept4Name: "xxxx"},
        {name: "舒鑫", jobNo: "985824", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "蓝轩", jobNo: "985828", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "范春梅", jobNo: "985830", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李超峰", jobNo: "985861", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "周佳霓", jobNo: "985863", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "马慧敏", jobNo: "985865", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张旭", jobNo: "985867", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "高若男", jobNo: "985869", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "张锦荣", jobNo: "985873", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "何霄", jobNo: "985875", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "姜囡鹃", jobNo: "985887", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "姜鹏芳", jobNo: "985889", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "何雪", jobNo: "985900", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "马文羽", jobNo: "985902", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郭佳", jobNo: "985904", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "袁璇", jobNo: "985906", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "蒋晨楷", jobNo: "985908", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "王凯琪", jobNo: "985910", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘烨", jobNo: "985912", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "张看", jobNo: "985914", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "包京京", jobNo: "985916", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "吴赛", jobNo: "985918", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "牛盼聪", jobNo: "985923", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "赵美晶", jobNo: "985971", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "褚浩南", jobNo: "985973", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "刘贝贝", jobNo: "985975", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马唯", jobNo: "985977", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "非林清", jobNo: "985979", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "赵卓园", jobNo: "985983", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "马馨雨", jobNo: "985985", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "刘玲", jobNo: "985987", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "宋凯丽", jobNo: "985989", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "徐淼泽", jobNo: "985991", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "李荣洁", jobNo: "985993", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "方雄", jobNo: "985997", lucky: "", deptName: "Quality & Operational Excellence", dept4Name: "xxxx"},
        {name: "马翼之", jobNo: "986050", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "黄弟翔", jobNo: "986064", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "周奕晴", jobNo: "986078", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王冰烃", jobNo: "986080", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "罗晨", jobNo: "986082", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "姚凯龙", jobNo: "986084", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "苏灿", jobNo: "986086", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "吴小婷", jobNo: "986104", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "马世祺", jobNo: "986106", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "孙莹", jobNo: "986129", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "苏燕", jobNo: "986131", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "姚敏", jobNo: "986153", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "徐黎晖", jobNo: "986174", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴鸿杰", jobNo: "986292", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邢敏慧", jobNo: "986313", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "荣方静", jobNo: "986338", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "王菁华", jobNo: "986386", lucky: "", deptName: "Research Areas & Collaborations", dept4Name: "xxxx"},
        {name: "陈佳文", jobNo: "986388", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "郭志新", jobNo: "986396", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "俞小芳", jobNo: "986436", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "栾硕", jobNo: "986440", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈娴", jobNo: "986442", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "黄晓斌", jobNo: "986474", lucky: "", deptName: "Digital Workplace Experience", dept4Name: "xxxx"},
        {name: "郭亭亭", jobNo: "986476", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "张志龙", jobNo: "986584", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "张靖文", jobNo: "986609", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "杨妍", jobNo: "986613", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邓珂", jobNo: "986630", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "陈学钊", jobNo: "986639", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "张皓泉", jobNo: "986658", lucky: "", deptName: "Protein Development Platform", dept4Name: "xxxx"},
        {name: "方思佳", jobNo: "986666", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "李亭", jobNo: "986696", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "韩迎春", jobNo: "986697", lucky: "", deptName: "Inventory and Production Planning", dept4Name: "xxxx"},
        {name: "方鑫园", jobNo: "986755", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吴瑶函", jobNo: "986799", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "冯滢", jobNo: "986809", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "范闪闪", jobNo: "986816", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "梁彤雨", jobNo: "986848", lucky: "", deptName: "In-house Manufacturing", dept4Name: "xxxx"},
        {name: "毛怡俊", jobNo: "986849", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "杨利娜", jobNo: "986929", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "吕向阳", jobNo: "986944", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "占永杰", jobNo: "986962", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "张凯", jobNo: "986971", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "彭晖", jobNo: "986994", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "洪运", jobNo: "987004", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "周逸阳", jobNo: "987021", lucky: "", deptName: "Portfolio Governance", dept4Name: "xxxx"},
        {name: "方珍珍", jobNo: "987053", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "汪洋", jobNo: "987084", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "夏雨欣", jobNo: "987096", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "邹童瑶", jobNo: "987111", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "叶艳玲", jobNo: "987172", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "司琪", jobNo: "987173", lucky: "", deptName: "Antibody Development Platform", dept4Name: "xxxx"},
        {name: "袁朝栋", jobNo: "987318", lucky: "", deptName: "Digital Customer", dept4Name: "xxxx"},
        {name: "刘云玥", jobNo: "987416", lucky: "", deptName: "Manufacturing Science and Engineering", dept4Name: "xxxx"},
        {name: "郑良明", jobNo: "987533", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "王舒欣", jobNo: "987565", lucky: "", deptName: "Logistics", dept4Name: "xxxx"},
        {name: "李恒凯", jobNo: "987531", lucky: "", deptName: "Facilities, Health & Safety", dept4Name: "xxxx"}
      ]

			init();

			function init() {
				var current;
				var posY;
				var removeRow;

				luckyers = localStorage.getItem('luckyers') ? JSON.parse(localStorage.getItem('luckyers')) : [];

				//移除中奖者
				_.remove(lotteryUsers, function(item) {
					var luckyer = {};
					luckyers.forEach(function(n){
						if(item.jobNo == n.jobNo) luckyer = n
					});
					return luckyer.jobNo == item.jobNo
				});

				//洗牌
				lotteryUsers.shuffle();

				renderLotteryInfo();

				cols = 30;
				rows = Math.ceil(lotteryUsers.length / cols);
				
				camera.position.set( 0, 0, 6000);

				removeRow = parseInt(luckyers.length / cols);
				posY = 1000 - removeRow * 50;

				// reset
				index = 0;
				copies = [];
				objects = [];
				targets = { table: [], sphere: [], helix: [], grid: [] };
				while(scene.children.length > 0){ 
				    scene.remove(scene.children[0]); 
				}

				// table
				for ( var i = 0; i < rows; i++ ) {
					for (var j = 0; j < cols; j++){
						if (!(index >= lotteryUsers.length)) {
							current = lotteryUsers[index];

							var element = document.createElement( 'div' );
							element.setAttribute('id', 'item_' + index++);
							element.className = 'element';
							element.style.backgroundColor = 'rgba(0,127,127,' + ( Math.random() * 0.5 + 0.25 ) + ')';

							// var img = document.createElement('img');
							// img.className = 'img';
							// img.src = imgs[0];
							// element.appendChild(img);

							var username = document.createElement( 'div' );
							username.className = 'name';
							username.innerHTML = current['name'];
							element.appendChild( username );

							var jobno = document.createElement( 'div' );
							jobno.className = 'jobno';
							jobno.innerHTML = current['jobNo'];
							element.appendChild( jobno );

							var object = new THREE.CSS3DObject( element );
							object.position.x = Math.random() * 4000 - 2000;
							object.position.y = Math.random() * 4000 - 2000;
							object.position.z = Math.random() * 4000 - 2000;
							scene.add( object );

							objects.push( object );
							copies.push(current);

							var object = new THREE.Object3D();
							object.position.x = ( j * 140 ) - 1800;
							object.position.y = - ( i * 140 ) + rows * 140 / 2;

							targets.table.push( object );
						}
					}
				}

				// sphere
				var vector = new THREE.Vector3();
				var spherical = new THREE.Spherical();
				for ( var i = 0, l = objects.length; i < l; i ++ ) {
					var phi = Math.acos( -1 + ( 2 * i ) / l );
					var theta = Math.sqrt( l * Math.PI ) * phi;
					var object = new THREE.Object3D();
					spherical.set( 800, phi, theta );
					object.position.setFromSpherical( spherical );
					vector.copy( object.position ).multiplyScalar( 2 );
					object.lookAt( vector );
					targets.sphere.push( object );
				}

				// grid
				for ( var i = 0; i < objects.length; i ++ ) {
					var object = new THREE.Object3D();
					object.position.x = ( ( i % 5 ) * 400 ) - 800;
					object.position.y = ( - ( Math.floor( i / 5 ) % 5 ) * 400 ) + 800;
					object.position.z = ( Math.floor( i / 25 ) ) * 1000 - 2000;
					targets.grid.push( object );
				}

				renderer = new THREE.CSS3DRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.domElement.style.position = 'absolute';
				document.getElementById( 'container' ).appendChild( renderer.domElement );

				controls = new THREE.TrackballControls( camera, renderer.domElement );
				this.zoomSpeed = 1;
				this.panSpeed = 0.2;
				controls.addEventListener( 'change', render );

				transform( targets.table, 2000 );
				animate();

				setTimeout(function() {
					$('#menu').fadeIn();
				}, 2000);
			}

			//更新抽奖中奖信息
			function renderLotteryInfo(){
				var group = _.groupBy(luckyers, 'lucky');
				var listHtml = '';
				console.log('中奖情况', group);

				for(var i = 0,len = prizeLevel.length; i < len; i++){
					var item = prizeLevel[i];
					var levelName = item.label; //奖项名称
					var levelLuckyers = group[levelName]; //该奖项中奖名单

					if(levelLuckyers){
						if(levelLuckyers.length == item.count){ //该奖项已抽完
							item.complete = true;
							item.surplus = 0;
						}else{	//未抽完
							item.surplus = item.count - levelLuckyers.length;
							currentLevel = item;
							break
						}
					}else{
						currentLevel = item;
						break
					}
				}
				console.log('当前奖项情况', currentLevel);
				
				if(currentLevel != undefined){
					if(currentLevel.label == 'levelTD' && currentLevel.surplus == 0){
						isOver = true;
						$('#info,#start,#stop').hide();
					}else{
						$('#info').html('接下来抽：'+currentLevel.text+'<br>剩余：'+currentLevel.surplus);
					}
					
				}
				for(var o in group){
					console.log(group);
					console.log(o);
					var level = _.find(prizeLevel, {'label': o});
					listHtml += '<h6>'+level.text+'</h6>';
					listHtml += '<ul>';
					group[o].forEach(function(item, index){
						listHtml += '<li>' + item.name + ' ' + item.jobNo + '</li>';
					});
					listHtml += '</ul>';
				}
				$('.list-box').html(listHtml);
			}


			//倒计时
        function timer() {
          if (time == 0) {
				  	isTimer = false;
					  $('#tip2, #countdown').fadeOut();
					  lotteryAni();
              time = 1;
            } else {
					      isTimer = true;
					      $('#countdown').text('GO');
					      TweenLite.fromTo($('#countdown'), 0.3, { autoAlpha: 0, scale: 0 }, { autoAlpha: .8, scale: 1, ease: Back.easeInOut, onComplete: function(){
						    time--;
						    setTimeout(function () {
							    timer();
						    },1000);
					}});
					
                }
            }


			function start() {
				if(!currentLevel) return false

				var tip = '';

				if (isStop) {
					isStop = false;
					document.getElementById('music').play();
					lotteryCount = currentLevel.n;

					if(currentLevel.n > currentLevel.surplus){
						lotteryCount = currentLevel.surplus;
					}

					hideTip();

					tip = '当前奖项：' + currentLevel.text + '<br>抽取名额：' + lotteryCount;
					
					$('.lottery-text').html(tip);
					$('#tip2, #countdown').fadeIn();

					timer();
				}
			}

			function lotteryAni(){
				var userLen = lotteryUsers.length;
				var movement = 0;

				if(userLen <= 353 && userLen > 326){ //阳光奖形式
					var seed = 1;
					var piece = parseInt(userLen / 25);
					var m = userLen / 1400;
					
					transform(targets.grid, 2000);
					camera.position.set( -100, 100, 1000 * piece); //1000为grid下的两片之间的距离

					function run() {
						if (movement < userLen) {
							seed += 0.005;
							controls.move(seed);
							movement += m;
						}else{
							movement = 0;
							seed = 1;
							camera.position.set( -100, 100, 1000 * piece);
						}
						timeid_eff = setTimeout(run, 10);
					}
					timeid_eff = setTimeout(run, 10);

					active();
				}else{ //剩余奖项形式
					var far = 4000;
					transform(targets.sphere, 1000);
					camera.position.set( 0, 0, 3000);

					function run() {
						movement = 0.002;
						controls.rotateCamera2(new THREE.Vector2(movement,0));
						timeid_eff = setTimeout(run, 20);
					}
					timeid_eff = setTimeout(run, 20);

					active2();
				}
			}


			function active() {
				timeid = setInterval(function() {
					$('.element').removeClass('active');
					var len = copies.length;
					var itemId1 = Math.floor(Math.random() * len);
					var itemId2 = Math.floor(Math.random() * len);
					var itemId3 = Math.floor(Math.random() * len);
					var itemId4 = Math.floor(Math.random() * len);
					var itemId5 = Math.floor(Math.random() * len);
					var itemId6 = Math.floor(Math.random() * len);
					var itemId7 = Math.floor(Math.random() * len);
					var itemId8 = Math.floor(Math.random() * len);
					$('#item_' + itemId1).addClass('active');
					$('#item_' + itemId2).addClass('active');
					$('#item_' + itemId3).addClass('active');
					$('#item_' + itemId4).addClass('active');
					$('#item_' + itemId5).addClass('active');
					$('#item_' + itemId6).addClass('active');
					$('#item_' + itemId7).addClass('active');
					$('#item_' + itemId8).addClass('active');
				}, 100);
			}

			function active2() {
				timeid = setInterval(function() {
					$('.element').removeClass('active');
					var len = copies.length;
					var itemId = Math.floor(Math.random() * len);
					$('#item_' + itemId).addClass('active');
				}, 100);
			}

			function stop(){
				var luckyNums,
					jobNo,
					name,
					luckyHtml = '<h2>恭喜'+currentLevel.text+'获得者</h2>',
					listHtml,
					param = [];

				isStop = true;
				document.getElementById('music').pause();

				if(lotteryCount > 30){
					$('#tip').addClass('wide');
					itemClass = 'luckyer-item4';
				}else if(lotteryCount > 10 && lotteryCount <= 30){
					$('#tip').removeClass('wide');
					itemClass = 'luckyer-item2';
				}else{
					$('#tip').removeClass('wide');
					itemClass = 'luckyer-item1';
				}

				
				if (timeid) {
					clearInterval(timeid);
				}
				if(timeid_eff){
					clearTimeout(timeid_eff);
				}

				for(var i = 0; i < lotteryCount; i++){
					var luckyNum = rand();
					var luckyItem = copies[luckyNum];
					luckyItem['lucky'] = currentLevel.label;
					luckyItem['remark'] = currentLevel.text;
					luckyHtml += '<div class="'+itemClass+'">' + luckyItem['name'] + ' '+ luckyItem['jobNo'] + '</div>';
					luckyers.push(luckyItem);
					param.push(luckyItem);
					delete copies[luckyNum];
				}

				localStorage.setItem('luckyers', JSON.stringify(luckyers));

				console.log('抽奖副本', copies);

				$('.element').removeClass('active');
				listHtml = $('<div class="luckyer-list"></div>').append(luckyHtml);
				$('#tip').append(listHtml).fadeIn();

				renderLotteryInfo();
				setTimeout(function(){
					init();
				}, 500);

					
			}

			function rand() {
				var n = Math.floor(Math.random() * copies.length);
				return copies[n] ? n : rand();
			}


			function hideTip() {
				$('#tip').fadeOut(function() {
					$(this).empty();
				});
			}

			function transform( targets, duration ) {
				TWEEN.removeAll();

				for ( var i = 0; i < objects.length; i ++ ) {
					var object = objects[ i ];
					var target = targets[ i ];

					new TWEEN.Tween( object.position )
						.to( { x: target.position.x, y: target.position.y, z: target.position.z }, Math.random() * duration + duration )
						.easing( TWEEN.Easing.Exponential.InOut )
						.start();

					new TWEEN.Tween( object.rotation )
						.to( { x: target.rotation.x, y: target.rotation.y, z: target.rotation.z }, Math.random() * duration + duration )
						.easing( TWEEN.Easing.Exponential.InOut )
						.start();
				}

				new TWEEN.Tween( this )
					.to( {}, duration * 2 )
					.onUpdate( render )
					.start();
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
				render();
			}

			function animate() {
				requestAnimationFrame( animate );
				TWEEN.update();
				controls.update();
			}

			function render() {
				renderer.render( scene, camera );
			}



			btnStart.addEventListener( 'click', function ( event ) {
				start();
				$('#start').blur();
			}, false );

			btnStop.addEventListener( 'click', function ( event ) {
				if(!isStop && !isTimer){
					stop();
				}
				
				$('#stop').blur();
			}, false );

			tip.addEventListener( 'click', function ( event ) {
				hideTip();
			}, false );

			btnLuckyers.addEventListener( 'click', function ( event ) {
				$('#list').fadeIn();
			}, false );

			$('#list').on('click', function ( event ) {
				$(this).fadeOut();
			});

			$(document).keydown(function(e){
			    if(!e) var e = window.event; 
			    if(e.keyCode == 32){
					if(isOver) return false;
			        if(isStop){
			        	start();
			        }else{
			        	if(!isTimer) stop();
			        }
			    }
			 });

			window.addEventListener( 'resize', onWindowResize, false );

		</script>
	</body>
</html>
